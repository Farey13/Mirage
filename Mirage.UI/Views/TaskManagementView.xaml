<UserControl x:Class="Mirage.UI.Views.TaskManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:viewModels="clr-namespace:Mirage.UI.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="900"
             Loaded="TaskManagementView_OnLoaded">

    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="5"/>
            <ColumnDefinition Width="1*"/>
        </Grid.ColumnDefinitions>

        <GroupBox Grid.Column="0" Header="Daily Task Definitions">
            <DataGrid ItemsSource="{Binding Tasks}" AutoGenerateColumns="False" IsReadOnly="True"
                      RowStyle="{StaticResource StandardDataGridRowStyle}">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Task Name" Binding="{Binding TaskName}" Width="2*"/>
                    <DataGridTextColumn Header="Schedule" Binding="{Binding ScheduleType}" Width="*"/>
                    <DataGridTextColumn Header="Value" Binding="{Binding ScheduleValue}" Width="*"/>
                    <DataGridTextColumn Header="Shift ID" Binding="{Binding ShiftID}" Width="*"/>
                    <DataGridCheckBoxColumn Header="Active" Binding="{Binding IsActive}" Width="50"/>

                    <!-- New Actions Column -->
                    <DataGridTemplateColumn Header="Actions" Width="80">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="Delete" 
                                        Background="IndianRed" 
                                        Foreground="White"
                                        Command="{Binding DataContext.DeleteTaskCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                        CommandParameter="{Binding}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Background="LightGray"/>

        <StackPanel Grid.Column="2" Margin="10,0,0,0">
            <TextBlock Text="Add New Task" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>

            <Label Content="Task Name"/>
            <TextBox Text="{Binding NewTaskName}" Margin="0,0,0,10"/>

            <Label Content="Assign to Shift"/>
            <ComboBox ItemsSource="{Binding Shifts}" 
                      SelectedItem="{Binding SelectedShift}"
                      DisplayMemberPath="ShiftName"
                      Margin="0,0,0,10"/>

            <Label Content="Schedule Type"/>
            <ComboBox ItemsSource="{Binding ScheduleTypes}" 
                      SelectedItem="{Binding SelectedScheduleType}"
                      Margin="0,0,0,10"/>

            <Label Content="Schedule Value (Optional)"/>
            <ComboBox ItemsSource="{Binding DaysOfWeek}" 
                      SelectedItem="{Binding ScheduleValue}"
                      mah:TextBoxHelper.Watermark="Select Day (if Weekly)"
                      Margin="0,0,0,20"/>

            <Button Content="Create Task" 
                    Command="{Binding SaveTaskCommand}" 
                    Style="{DynamicResource MahApps.Styles.Button.Accent}"/>
        </StackPanel>
    </Grid>
</UserControl>