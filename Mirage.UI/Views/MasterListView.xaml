<UserControl x:Class="Mirage.UI.Views.MasterListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:viewModels="clr-namespace:Mirage.UI.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="900"
             Loaded="MasterListView_OnLoaded">


    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- List Selection Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <Label Content="Manage List:" FontWeight="Bold" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding ListTypes}" SelectedItem="{Binding SelectedListType}" Width="200"/>
        </StackPanel>

        <!-- Main Content Area -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="1*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel - List Items -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Search Box -->
                <TextBox Text="{Binding SearchFilter, UpdateSourceTrigger=PropertyChanged}" 
                         mah:TextBoxHelper.Watermark="Search items..." 
                         Margin="0,0,0,5"/>

                <!-- Data Grid -->
                <GroupBox Grid.Row="1" Header="List Items">
                    <DataGrid ItemsSource="{Binding FilteredItems}" 
                              SelectedItem="{Binding SelectedItem}"
                              RowStyle="{StaticResource StandardDataGridRowStyle}"
                              AutoGenerateColumns="False" 
                              IsReadOnly="True" 
                              AlternationCount="2">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Value" Binding="{Binding ItemValue}" Width="*"/>
                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="1.5*"/>
                            <DataGridCheckBoxColumn Header="Is Active" Binding="{Binding IsActive}" Width="Auto"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
            </Grid>

            <!-- Grid Splitter -->
            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Background="LightGray"/>

            <!-- Right Panel - Edit Controls -->
            <StackPanel Grid.Column="2">
                <Button Content="Add New Item" Command="{Binding NewItemCommand}" Margin="0,0,0,10"/>
                <GroupBox Header="Edit Item" IsEnabled="{Binding IsEditing}">
                    <StackPanel Margin="10">
                        <Label Content="Item Value"/>
                        <TextBox Text="{Binding EditItemValue, UpdateSourceTrigger=PropertyChanged}" 
                                 Margin="0,0,0,10"/>

                        <Label Content="Description"/>
                        <TextBox Text="{Binding EditDescription, UpdateSourceTrigger=PropertyChanged}" 
                                 Margin="0,0,0,10" 
                                 Height="60" 
                                 TextWrapping="Wrap" 
                                 AcceptsReturn="True"/>

                        <mah:ToggleSwitch Content="Is Active" 
                                        IsOn="{Binding IsItemActive}" 
                                        Margin="0,0,0,20"/>

                        <Button Content="Save Changes" 
                                Command="{Binding SaveItemCommand}" 
                                Style="{DynamicResource MahApps.Styles.Button.Accent}"/>
                    </StackPanel>
                </GroupBox>
            </StackPanel>
        </Grid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2" Margin="0,5,0,0">
            <StatusBarItem>
                <TextBlock Text="{Binding ItemCount, StringFormat='{}Items: {0}'}"/>
            </StatusBarItem>
            <Separator Style="{StaticResource MahApps.Styles.Separator.StatusBar}"/>
            <StatusBarItem>
                <TextBlock Text="{Binding SelectedListType, StringFormat='{}Current List: {0}'}"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</UserControl>